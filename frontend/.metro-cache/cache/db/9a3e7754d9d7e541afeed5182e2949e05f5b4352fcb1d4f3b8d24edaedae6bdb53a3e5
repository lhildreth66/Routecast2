{"dependencies":[{"name":"../types.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":89},"end":{"line":7,"column":40,"index":129}}],"key":"8cLkkKYebhz8179+ortY3/pylDg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  /**\n   * Error utilities for parsing platform-specific error responses\n   */\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.parseErrorStringToJsonObj = parseErrorStringToJsonObj;\n  exports.isUserCancelledError = isUserCancelledError;\n  var _typesJs = require(_dependencyMap[0], \"../types.js\");\n  /**\n   * Parses error string from native modules into a structured error object\n   *\n   * Native modules return errors in different formats:\n   * - Android: JSON string like '{\"code\":\"E_USER_CANCELLED\",\"message\":\"User cancelled the purchase\",\"responseCode\":1}'\n   * - iOS: JSON string or plain message\n   * - Legacy: \"CODE: message\" format\n   *\n   * @param errorString - The error string from native module\n   * @returns Parsed error object with code and message\n   */\n  function parseErrorStringToJsonObj(errorString) {\n    // Handle Error objects\n    if (errorString instanceof Error) {\n      errorString = errorString.message;\n    }\n\n    // Handle non-string inputs\n    if (typeof errorString !== 'string') {\n      return {\n        code: _typesJs.ErrorCode.Unknown,\n        message: 'Unknown error occurred'\n      };\n    }\n\n    // Try to parse as JSON first\n    try {\n      var parsed = JSON.parse(errorString);\n      if (typeof parsed === 'object' && parsed !== null) {\n        // Ensure it has at least code and message\n        return {\n          code: parsed.code || _typesJs.ErrorCode.Unknown,\n          message: parsed.message || errorString,\n          ...parsed\n        };\n      }\n    } catch {\n      // Not JSON, continue with other formats\n    }\n\n    // Try to parse \"CODE: message\" format\n    var colonIndex = errorString.indexOf(':');\n    if (colonIndex > 0 && colonIndex < 50) {\n      // Reasonable position for error code\n      var potentialCode = errorString.substring(0, colonIndex).trim();\n      // Check if it looks like an error code (starts with E_ or contains uppercase)\n      if (potentialCode.startsWith('E_') || /^[A-Z_]+$/.test(potentialCode)) {\n        return {\n          code: potentialCode,\n          message: errorString.substring(colonIndex + 1).trim()\n        };\n      }\n    }\n\n    // Fallback: treat entire string as message\n    return {\n      code: _typesJs.ErrorCode.Unknown,\n      message: errorString\n    };\n  }\n\n  /**\n   * Checks if an error code indicates user cancellation\n   * @param error - Error object or string\n   * @returns true if the error is a user cancellation\n   */\n  function isUserCancelledError(error) {\n    var errorObj = typeof error === 'object' && error !== null && 'code' in error ? error : parseErrorStringToJsonObj(error);\n    return errorObj.code === _typesJs.ErrorCode.UserCancelled || errorObj.code === 'E_USER_CANCELED' ||\n    // Alternative spelling\n    errorObj.responseCode === 1; // Android BillingClient.BillingResponseCode.USER_CANCELED\n  }\n});","lineCount":85,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[5,0,4,0],[6,0,5,0],[7,2,3,0,"Object"],[7,8,3,0],[7,9,3,0,"defineProperty"],[7,23,3,0],[7,24,3,0,"exports"],[7,31,3,0],[8,4,3,0,"value"],[8,9,3,0],[9,2,3,0],[10,2,19,0,"exports"],[10,9,19,0],[10,10,19,0,"parseErrorStringToJsonObj"],[10,35,19,0],[10,38,19,0,"parseErrorStringToJsonObj"],[10,63,19,0],[11,2,74,0,"exports"],[11,9,74,0],[11,10,74,0,"isUserCancelledError"],[11,30,74,0],[11,33,74,0,"isUserCancelledError"],[11,53,74,0],[12,2,7,0],[12,6,7,0,"_typesJs"],[12,14,7,0],[12,17,7,0,"require"],[12,24,7,0],[12,25,7,0,"_dependencyMap"],[12,39,7,0],[13,2,8,0],[14,0,9,0],[15,0,10,0],[16,0,11,0],[17,0,12,0],[18,0,13,0],[19,0,14,0],[20,0,15,0],[21,0,16,0],[22,0,17,0],[23,0,18,0],[24,2,19,7],[24,11,19,16,"parseErrorStringToJsonObj"],[24,36,19,41,"parseErrorStringToJsonObj"],[24,37,19,42,"errorString"],[24,48,19,53],[24,50,19,55],[25,4,20,2],[26,4,21,2],[26,8,21,6,"errorString"],[26,19,21,17],[26,31,21,29,"Error"],[26,36,21,34],[26,38,21,36],[27,6,22,4,"errorString"],[27,17,22,15],[27,20,22,18,"errorString"],[27,31,22,29],[27,32,22,30,"message"],[27,39,22,37],[28,4,23,2],[30,4,25,2],[31,4,26,2],[31,8,26,6],[31,15,26,13,"errorString"],[31,26,26,24],[31,31,26,29],[31,39,26,37],[31,41,26,39],[32,6,27,4],[32,13,27,11],[33,8,28,6,"code"],[33,12,28,10],[33,14,28,12,"ErrorCode"],[33,22,28,21],[33,23,28,21,"ErrorCode"],[33,32,28,21],[33,33,28,22,"Unknown"],[33,40,28,29],[34,8,29,6,"message"],[34,15,29,13],[34,17,29,15],[35,6,30,4],[35,7,30,5],[36,4,31,2],[38,4,33,2],[39,4,34,2],[39,8,34,6],[40,6,35,4],[40,10,35,10,"parsed"],[40,16,35,16],[40,19,35,19,"JSON"],[40,23,35,23],[40,24,35,24,"parse"],[40,29,35,29],[40,30,35,30,"errorString"],[40,41,35,41],[40,42,35,42],[41,6,36,4],[41,10,36,8],[41,17,36,15,"parsed"],[41,23,36,21],[41,28,36,26],[41,36,36,34],[41,40,36,38,"parsed"],[41,46,36,44],[41,51,36,49],[41,55,36,53],[41,57,36,55],[42,8,37,6],[43,8,38,6],[43,15,38,13],[44,10,39,8,"code"],[44,14,39,12],[44,16,39,14,"parsed"],[44,22,39,20],[44,23,39,21,"code"],[44,27,39,25],[44,31,39,29,"ErrorCode"],[44,39,39,38],[44,40,39,38,"ErrorCode"],[44,49,39,38],[44,50,39,39,"Unknown"],[44,57,39,46],[45,10,40,8,"message"],[45,17,40,15],[45,19,40,17,"parsed"],[45,25,40,23],[45,26,40,24,"message"],[45,33,40,31],[45,37,40,35,"errorString"],[45,48,40,46],[46,10,41,8],[46,13,41,11,"parsed"],[47,8,42,6],[47,9,42,7],[48,6,43,4],[49,4,44,2],[49,5,44,3],[49,6,44,4],[49,12,44,10],[50,6,45,4],[51,4,45,4],[53,4,48,2],[54,4,49,2],[54,8,49,8,"colonIndex"],[54,18,49,18],[54,21,49,21,"errorString"],[54,32,49,32],[54,33,49,33,"indexOf"],[54,40,49,40],[54,41,49,41],[54,44,49,44],[54,45,49,45],[55,4,50,2],[55,8,50,6,"colonIndex"],[55,18,50,16],[55,21,50,19],[55,22,50,20],[55,26,50,24,"colonIndex"],[55,36,50,34],[55,39,50,37],[55,41,50,39],[55,43,50,41],[56,6,51,4],[57,6,52,4],[57,10,52,10,"potentialCode"],[57,23,52,23],[57,26,52,26,"errorString"],[57,37,52,37],[57,38,52,38,"substring"],[57,47,52,47],[57,48,52,48],[57,49,52,49],[57,51,52,51,"colonIndex"],[57,61,52,61],[57,62,52,62],[57,63,52,63,"trim"],[57,67,52,67],[57,68,52,68],[57,69,52,69],[58,6,53,4],[59,6,54,4],[59,10,54,8,"potentialCode"],[59,23,54,21],[59,24,54,22,"startsWith"],[59,34,54,32],[59,35,54,33],[59,39,54,37],[59,40,54,38],[59,44,54,42],[59,55,54,53],[59,56,54,54,"test"],[59,60,54,58],[59,61,54,59,"potentialCode"],[59,74,54,72],[59,75,54,73],[59,77,54,75],[60,8,55,6],[60,15,55,13],[61,10,56,8,"code"],[61,14,56,12],[61,16,56,14,"potentialCode"],[61,29,56,27],[62,10,57,8,"message"],[62,17,57,15],[62,19,57,17,"errorString"],[62,30,57,28],[62,31,57,29,"substring"],[62,40,57,38],[62,41,57,39,"colonIndex"],[62,51,57,49],[62,54,57,52],[62,55,57,53],[62,56,57,54],[62,57,57,55,"trim"],[62,61,57,59],[62,62,57,60],[63,8,58,6],[63,9,58,7],[64,6,59,4],[65,4,60,2],[67,4,62,2],[68,4,63,2],[68,11,63,9],[69,6,64,4,"code"],[69,10,64,8],[69,12,64,10,"ErrorCode"],[69,20,64,19],[69,21,64,19,"ErrorCode"],[69,30,64,19],[69,31,64,20,"Unknown"],[69,38,64,27],[70,6,65,4,"message"],[70,13,65,11],[70,15,65,13,"errorString"],[71,4,66,2],[71,5,66,3],[72,2,67,0],[74,2,69,0],[75,0,70,0],[76,0,71,0],[77,0,72,0],[78,0,73,0],[79,2,74,7],[79,11,74,16,"isUserCancelledError"],[79,31,74,36,"isUserCancelledError"],[79,32,74,37,"error"],[79,37,74,42],[79,39,74,44],[80,4,75,2],[80,8,75,8,"errorObj"],[80,16,75,16],[80,19,75,19],[80,26,75,26,"error"],[80,31,75,31],[80,36,75,36],[80,44,75,44],[80,48,75,48,"error"],[80,53,75,53],[80,58,75,58],[80,62,75,62],[80,66,75,66],[80,72,75,72],[80,76,75,76,"error"],[80,81,75,81],[80,84,75,84,"error"],[80,89,75,89],[80,92,75,92,"parseErrorStringToJsonObj"],[80,117,75,117],[80,118,75,118,"error"],[80,123,75,123],[80,124,75,124],[81,4,76,2],[81,11,76,9,"errorObj"],[81,19,76,17],[81,20,76,18,"code"],[81,24,76,22],[81,29,76,27,"ErrorCode"],[81,37,76,36],[81,38,76,36,"ErrorCode"],[81,47,76,36],[81,48,76,37,"UserCancelled"],[81,61,76,50],[81,65,76,54,"errorObj"],[81,73,76,62],[81,74,76,63,"code"],[81,78,76,67],[81,83,76,72],[81,100,76,89],[82,4,77,2],[83,4,78,2,"errorObj"],[83,12,78,10],[83,13,78,11,"responseCode"],[83,25,78,23],[83,30,78,28],[83,31,78,29],[83,32,78,30],[83,33,78,31],[84,2,79,0],[85,0,79,1],[85,3]],"functionMap":{"names":["<global>","parseErrorStringToJsonObj","isUserCancelledError"],"mappings":"AAA;OCkB;CDgD;OEO;CFK"},"hasCjsExports":false},"type":"js/module"}]}