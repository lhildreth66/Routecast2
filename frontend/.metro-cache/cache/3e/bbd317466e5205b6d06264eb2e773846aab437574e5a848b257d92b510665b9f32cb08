{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":12,"column":0,"index":233},"end":{"line":12,"column":65,"index":298}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/AppState","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"JfCM6WRyn2619+pzBJhEHd1+SSw=","exportNames":["*"],"imports":1}},{"name":"./iapClient","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":15,"column":0,"index":421},"end":{"line":15,"column":40,"index":461}}],"key":"GEI4obFima5P6vkJUxzBXpwdcZ0=","exportNames":["*"],"imports":1}},{"name":"./entitlements","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":16,"column":0,"index":462},"end":{"line":16,"column":51,"index":513}}],"key":"TCV4PVJ9w9IttLvA/oNRiZFzZpQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,d){\"use strict\";Object.defineProperty(_e,'__esModule',{value:!0}),_e.performVerification=u,_e.useEntitlements=function(){const[e,n]=(0,t.useState)(null),[f,p]=(0,t.useState)(!0),[h,C]=(0,t.useState)(null),E=(0,t.useRef)(null),w=(0,t.useRef)(0),y=(0,t.useCallback)(async(e=!1)=>{const t=Date.now();if(!e&&t-w.current<3e4)console.log('[useEntitlements] Skipping verification (too soon)');else{w.current=t;try{console.log('[useEntitlements] Verifying entitlement...'),p(!0),C(null);const e=await u();n(e),await o.entitlementsCache.updateVerificationTime()}catch(e){console.error('[useEntitlements] Verification failed:',e),C(e instanceof Error?e.message:'Verification failed');const t=await o.entitlementsCache.load();if(t&&o.entitlementsCache.isValid(t)){const e=o.entitlementsCache.toEntitlement(t);n(e)}else{const e=o.entitlementsCache.createLocked();n(e)}}finally{p(!1)}}},[]),v=(0,t.useCallback)(async e=>{try{console.log('[useEntitlements] Processing purchase update:',e.productId),await c.iapClient.finalizePurchase(e),await y(!0)}catch(e){console.error('[useEntitlements] Failed to process purchase:',e),C(e instanceof Error?e.message:'Purchase processing failed')}},[y]),P=(0,t.useCallback)(e=>{console.error('[useEntitlements] Purchase error:',e),C(e.message||'Purchase failed')},[]);(0,t.useEffect)(()=>{let e=!0;return(async()=>{try{await c.iapClient.initialize(),c.iapClient.setupListeners(v,P),e&&await y()}catch(t){console.error('[useEntitlements] Initialization failed:',t),e&&(C(t instanceof Error?t.message:'Initialization failed'),p(!1))}})(),()=>{e=!1,c.iapClient.disconnect()}},[y,v,P]),(0,t.useEffect)(()=>(E.current=setInterval(()=>{console.log('[useEntitlements] Periodic verification triggered'),y()},l),()=>{E.current&&clearInterval(E.current)}),[y]),(0,t.useEffect)(()=>{const e=s.default.addEventListener('change',e=>{'active'===e&&(console.log('[useEntitlements] App foregrounded, verifying...'),y())});return()=>{e.remove()}},[y]);const I=(0,t.useCallback)(()=>y(!0),[y]);return{entitlement:e,isLoading:f,error:h,refresh:I}};var e,t=r(d[0]),n=r(d[1]),s=(e=n)&&e.__esModule?e:{default:e},c=r(d[2]),o=r(d[3]);const l=432e5;async function u(){const e=await c.iapClient.getActivePurchase();if(e){const t=e.productId,n=e.transactionDate||Date.now();await o.entitlementsCache.updateFromPurchase(t,n);const s=await o.entitlementsCache.load();if(s)return{isPro:!0,productId:s.productId,expireAt:s.expireAt,source:'play'}}const t=await o.entitlementsCache.load();return t&&o.entitlementsCache.isValid(t)?o.entitlementsCache.toEntitlement(t):o.entitlementsCache.createLocked()}});","lineCount":1,"map":[[1,92,21,0,"_e"],[1,95,21,0,"performVerification"],[1,117,52,0,"_e"],[1,120,52,0,"useEntitlements"],[1,136,52,7],[1,147,53,2],[1,153,53,9,"entitlement"],[1,155,53,22,"setEntitlement"],[1,159,53,40],[1,161,53,40,"useState"],[1,163,53,48,"useState"],[1,173,53,69],[1,180,54,9,"isLoading"],[1,182,54,20,"setIsLoading"],[1,186,54,36],[1,188,54,36,"useState"],[1,190,54,44,"useState"],[1,201,54,45],[1,205,55,9,"error"],[1,207,55,16,"setError"],[1,211,55,28],[1,213,55,28,"useState"],[1,215,55,36,"useState"],[1,225,55,52],[1,231,57,8,"verifyTimerRef"],[1,234,57,25],[1,236,57,25,"useRef"],[1,238,57,31,"useRef"],[1,246,57,55],[1,252,58,8,"lastVerifyTimeRef"],[1,255,58,28],[1,257,58,28,"useRef"],[1,259,58,34,"useRef"],[1,267,58,43],[1,270,64,8,"verify"],[1,273,64,17],[1,275,64,17,"useCallback"],[1,277,64,28,"useCallback"],[1,290,64,29,"async"],[1,296,64,36,"force"],[1,299,64,44],[1,304,66,4],[1,310,66,10,"now"],[1,312,66,16,"Date"],[1,317,66,21,"now"],[1,323,67,4],[1,327,67,9,"force"],[1,330,67,18,"now"],[1,332,67,24,"lastVerifyTimeRef"],[1,334,67,42,"current"],[1,342,67,52],[1,346,68,6,"console"],[1,354,68,14,"log"],[1,358,68,18],[1,416,67,4],[1,417,71,4,"lastVerifyTimeRef"],[1,419,71,22,"current"],[1,427,71,32,"now"],[1,429,73,4],[1,433,74,6,"console"],[1,441,74,14,"log"],[1,445,74,18],[1,491,75,6,"setIsLoading"],[1,494,75,19],[1,497,76,6,"setError"],[1,499,76,15],[1,505,78,6],[1,511,78,12,"ent"],[1,519,78,24,"performVerification"],[1,523,79,6,"setEntitlement"],[1,525,79,21,"ent"],[1,534,82,12,"entitlementsCache"],[1,536,82,29,"entitlementsCache"],[1,554,82,30,"updateVerificationTime"],[1,578,83,4],[1,579,83,6],[1,585,83,13,"err"],[1,588,84,6,"console"],[1,596,84,14,"error"],[1,602,84,20],[1,643,84,62,"err"],[1,646,85,6,"setError"],[1,648,85,15,"err"],[1,661,85,30,"Error"],[1,667,85,38,"err"],[1,669,85,42,"message"],[1,677,85,52],[1,700,88,6],[1,706,88,12,"cached"],[1,714,88,27,"entitlementsCache"],[1,716,88,44,"entitlementsCache"],[1,734,88,45,"load"],[1,741,89,6],[1,744,89,10,"cached"],[1,747,89,20,"entitlementsCache"],[1,749,89,37,"entitlementsCache"],[1,767,89,38,"isValid"],[1,775,89,46,"cached"],[1,778,89,55],[1,779,90,8],[1,785,90,14,"ent"],[1,787,90,20,"entitlementsCache"],[1,789,90,37,"entitlementsCache"],[1,807,90,38,"toEntitlement"],[1,821,90,52,"cached"],[1,824,91,8,"setEntitlement"],[1,826,91,23,"ent"],[1,828,92,6],[1,833,92,13],[1,834,93,8],[1,840,93,14,"locked"],[1,842,93,23,"entitlementsCache"],[1,844,93,40,"entitlementsCache"],[1,862,93,41,"createLocked"],[1,877,94,8,"setEntitlement"],[1,879,94,23,"locked"],[1,881,95,6],[1,882,96,4],[1,883,96,5],[1,891,97,6,"setIsLoading"],[1,894,97,19],[1,896,98,4],[1,897,70,4],[1,900,99,5],[1,904,104,8,"handlePurchaseUpdate"],[1,907,104,31],[1,909,104,31,"useCallback"],[1,911,104,42,"useCallback"],[1,924,104,43,"async"],[1,934,105,4],[1,938,106,6,"console"],[1,946,106,14,"log"],[1,950,106,18],[1,998,106,67,"purchase"],[1,1000,106,76,"productId"],[1,1017,109,12,"iapClient"],[1,1019,109,21,"iapClient"],[1,1029,109,22,"finalizePurchase"],[1,1046,109,39,"purchase"],[1,1055,112,12,"verify"],[1,1058,112,19],[1,1060,113,4],[1,1061,113,6],[1,1067,113,13,"err"],[1,1070,114,6,"console"],[1,1078,114,14,"error"],[1,1084,114,20],[1,1132,114,69,"err"],[1,1135,115,6,"setError"],[1,1137,115,15,"err"],[1,1150,115,30,"Error"],[1,1156,115,38,"err"],[1,1158,115,42,"message"],[1,1166,115,52],[1,1195,116,4],[1,1198,117,5],[1,1199,117,6,"verify"],[1,1203,122,8,"handlePurchaseError"],[1,1206,122,30],[1,1208,122,30,"useCallback"],[1,1210,122,41,"useCallback"],[1,1223,122,43,"err"],[1,1227,123,4,"console"],[1,1235,123,12,"error"],[1,1241,123,18],[1,1277,123,55,"err"],[1,1280,124,4,"setError"],[1,1282,124,13,"err"],[1,1284,124,17,"message"],[1,1293,124,28],[1,1313,125,5],[1,1318,130,2],[1,1320,130,2,"useEffect"],[1,1322,130,11,"useEffect"],[1,1333,130,12],[1,1338,131,4],[1,1342,131,8,"mounted"],[1,1345,131,18],[1,1347,153,4],[1,1353,133,17,"async"],[1,1364,134,6],[1,1374,135,14,"iapClient"],[1,1376,135,23,"iapClient"],[1,1386,135,24,"initialize"],[1,1399,136,8,"iapClient"],[1,1401,136,17,"iapClient"],[1,1411,136,18,"setupListeners"],[1,1426,136,33,"handlePurchaseUpdate"],[1,1428,136,55,"handlePurchaseError"],[1,1431,138,12,"mounted"],[1,1440,140,16,"verify"],[1,1443,142,6],[1,1444,142,8],[1,1450,142,15,"err"],[1,1453,143,8,"console"],[1,1461,143,16,"error"],[1,1467,143,22],[1,1510,143,66,"err"],[1,1513,144,12,"mounted"],[1,1517,145,10,"setError"],[1,1519,145,19,"err"],[1,1532,145,34,"Error"],[1,1538,145,42,"err"],[1,1540,145,46,"message"],[1,1548,145,56],[1,1573,146,10,"setIsLoading"],[1,1576,146,23],[1,1579,148,6],[1,1582,151,4,"init"],[1,1585,153,11],[1,1590,154,6,"mounted"],[1,1593,154,16],[1,1595,155,6,"iapClient"],[1,1597,155,15,"iapClient"],[1,1607,155,16,"disconnect"],[1,1622,157,5],[1,1623,157,6,"verify"],[1,1625,157,14,"handlePurchaseUpdate"],[1,1627,157,36,"handlePurchaseError"],[1,1632,162,2],[1,1634,162,2,"useEffect"],[1,1636,162,11,"useEffect"],[1,1647,162,12],[1,1652,163,4,"verifyTimerRef"],[1,1654,163,19,"current"],[1,1662,163,29,"setInterval"],[1,1674,163,41],[1,1679,164,6,"console"],[1,1687,164,14,"log"],[1,1691,164,18],[1,1744,165,6,"verify"],[1,1749,166,7,"VERIFY_INTERVAL_MS"],[1,1752,168,11],[1,1757,169,10,"verifyTimerRef"],[1,1759,169,25,"current"],[1,1768,170,8,"clearInterval"],[1,1782,170,22,"verifyTimerRef"],[1,1784,170,37,"current"],[1,1795,173,5],[1,1796,173,6,"verify"],[1,1801,178,2],[1,1803,178,2,"useEffect"],[1,1805,178,11,"useEffect"],[1,1816,178,12],[1,1821,179,4],[1,1827,179,10,"subscription"],[1,1829,179,25,"AppState"],[1,1831,179,33,"default"],[1,1839,179,34,"addEventListener"],[1,1856,179,51],[1,1865,179,62,"nextAppState"],[1,1869,180,27],[1,1880,180,10,"nextAppState"],[1,1884,181,8,"console"],[1,1892,181,16,"log"],[1,1896,181,20],[1,1948,182,8,"verify"],[1,1955,186,4],[1,1961,186,11],[1,1966,187,6,"subscription"],[1,1968,187,19,"remove"],[1,1979,189,5],[1,1980,189,6,"verify"],[1,1984,194,2],[1,1990,194,8,"refresh"],[1,1993,194,18],[1,1995,194,18,"useCallback"],[1,1997,194,29,"useCallback"],[1,2010,194,30],[1,2014,195,11,"verify"],[1,2017,195,18],[1,2020,196,5],[1,2021,196,6,"verify"],[1,2025,198,2],[1,2031,198,9],[1,2032,199,4,"entitlement"],[1,2046,200,4,"isLoading"],[1,2058,201,4,"error"],[1,2066,202,4,"refresh"],[1,2076,204,0],[1,2078,12,0],[1,2082],[1,2084,12,0,"_react"],[1,2086,12,0,"r"],[1,2088,12,0,"d"],[1,2090,12,0],[1,2094,12,65,"_reactNativeWebDistExportsAppState"],[1,2096,12,65,"r"],[1,2098,12,65,"d"],[1,2100,12,65],[1,2104,12,65,"AppState"],[1,2107],[1,2109,12,65,"_reactNativeWebDistExportsAppState"],[1,2113],[1,2140,15,0,"_iapClient"],[1,2142,15,0,"r"],[1,2144,15,0,"d"],[1,2146,15,0],[1,2150,16,0,"_entitlements"],[1,2152,16,0,"r"],[1,2154,16,0,"d"],[1,2156,16,0],[1,2160,19,0],[1,2166,19,6,"VERIFY_INTERVAL_MS"],[1,2168,19,24],[1,2174,21,7,"async"],[1,2189,21,22,"performVerification"],[1,2193,23,2],[1,2199,23,8,"activePurchase"],[1,2207,23,31,"iapClient"],[1,2209,23,40,"iapClient"],[1,2219,23,41,"getActivePurchase"],[1,2239,25,2],[1,2242,25,6,"activePurchase"],[1,2244,25,22],[1,2245,27,4],[1,2251,27,10,"productId"],[1,2253,27,22,"activePurchase"],[1,2255,27,37,"productId"],[1,2265,28,10,"purchaseDate"],[1,2267,28,25,"activePurchase"],[1,2269,28,40,"transactionDate"],[1,2286,28,59,"Date"],[1,2291,28,64,"now"],[1,2303,30,10,"entitlementsCache"],[1,2305,30,27,"entitlementsCache"],[1,2323,30,28,"updateFromPurchase"],[1,2342,30,47,"productId"],[1,2344,30,58,"purchaseDate"],[1,2347,32,4],[1,2353,32,10,"cached"],[1,2361,32,25,"entitlementsCache"],[1,2363,32,42,"entitlementsCache"],[1,2381,32,43,"load"],[1,2388,33,4],[1,2391,33,8,"cached"],[1,2393,34,6],[1,2399,34,13],[1,2400,35,8,"isPro"],[1,2407,35,15],[1,2409,36,8,"productId"],[1,2419,36,19,"cached"],[1,2421,36,26,"productId"],[1,2431,37,8,"expireAt"],[1,2440,37,18,"cached"],[1,2442,37,25,"expireAt"],[1,2451,38,8,"source"],[1,2458,38,16],[1,2465,41,2],[1,2466,44,2],[1,2472,44,8,"cached"],[1,2480,44,23,"entitlementsCache"],[1,2482,44,40,"entitlementsCache"],[1,2500,44,41,"load"],[1,2507,45,2],[1,2514,45,6,"cached"],[1,2517,45,16,"entitlementsCache"],[1,2519,45,33,"entitlementsCache"],[1,2537,45,34,"isValid"],[1,2545,45,42,"cached"],[1,2548,46,11,"entitlementsCache"],[1,2550,46,28,"entitlementsCache"],[1,2568,46,29,"toEntitlement"],[1,2582,46,43,"cached"],[1,2585,49,9,"entitlementsCache"],[1,2587,49,26,"entitlementsCache"],[1,2605,49,27,"createLocked"],[1,2619,50,0],[1,2620,204,1],[1,2623]],"functionMap":{"names":["<global>","performVerification","useEntitlements","verify","handlePurchaseUpdate","handlePurchaseError","useEffect$argument_0","init","<anonymous>","setInterval$argument_0","AppState.addEventListener$argument_1","refresh"],"mappings":"AAA;OCoB;CD6B;OEE;6BCY;GDmC;2CEK;GFa;0CGK;GHG;YIK;iBCG;KDgB;WEI;KFG;GJC;YIK;yCGC;KHG;WEE;KFI;GJC;YIK;6DIC;KJK;WEE;KFE;GJC;8BSK;GTE;CFQ"},"hasCjsExports":false},"type":"js/module"}]}